# 音频处理演示程序

基于02_mfcc.py开发的音频处理演示程序，专注于产生听觉明显不同的前后音频对比效果。

## 功能特点

- ✅ **音频下载功能**：支持从URL下载示例音频
- ✅ **多种音频处理效果**：音高变换、时间拉伸、失真、混响等
- ✅ **噪声清理和语音增强**：谱减法降噪、语音频段增强、动态压缩
- ✅ **听觉明显对比**：处理后音频与原始音频在听觉上有显著差异
- ✅ **可视化分析**：波形、频谱、MFCC特征对比图表
- ✅ **音频文件保存**：可保存原始和处理后的音频文件
- ✅ **交互式界面**：用户友好的命令行交互界面

## 安装依赖

```bash
pip install numpy matplotlib librosa sounddevice soundfile scipy requests ipython
```

## 使用方法

### 1. 运行主程序

```bash
python audio_processing_demo.py
```

### 2. 选择演示模式

程序提供三种演示模式：
- **交互式演示**：完整的交互体验，可选择音频来源和处理效果
- **快速示例演示**：使用预设的示例URL快速演示
- **自定义处理**：直接输入URL进行自定义处理

### 3. 音频来源选择

- **从URL下载音频**：输入音频文件的URL地址
- **使用内置示例音频**：使用librosa自带的示例音频
- **实时录音**：通过麦克风录制音频
- **生成测试音频**：程序生成测试音频信号

### 4. 处理效果选择

程序提供多种音频处理效果：

1. **戏剧性变化**（推荐）：组合音高变换+时间拉伸+失真+混响
2. **音高变换**：改变音频的音高（半音为单位）
3. **时间拉伸**：改变音频的播放速度
4. **低通滤波**：让声音变闷
5. **高通滤波**：让声音变尖
6. **失真效果**：添加失真效果
7. **混响效果**：添加混响效果

## 示例URL

程序内置了以下示例音频URL：
1. StarWars60.wav - 星球大战音效
2. ImperialMarch60.wav - 帝国进行曲
3. CantinaBand60.wav - 酒馆乐队音乐
4. preamble10.wav - 演讲片段

## 输出结果

程序会提供完整的对比分析：

### 音频播放对比
- 播放原始音频
- 播放处理后的音频

### 可视化分析
- 波形对比图
- 频谱对比图
- 频谱包络对比
- MFCC特征对比

### 音频特征分析
- RMS音量对比
- 频谱质心变化
- 音量变化倍数

### 文件保存
程序会在项目目录中创建专门的文件夹来组织文件：
- **downloaded_audio/** - 存放从URL下载的原始音频文件
- **processed_audio/** - 存放处理前后的音频对比文件

文件命名格式：
- 下载的音频：保持原始文件名
- 对比音频：`audio_comparison_original_1234.wav` 和 `audio_comparison_processed_1234.wav`

## 技术特点

### 音频处理算法
- **音高变换**：使用librosa的音高变换算法
- **时间拉伸**：基于相位声码器的时间拉伸
- **失真效果**：软削波失真算法
- **混响效果**：简单的延迟线混响实现
- **滤波器**：巴特沃斯数字滤波器

### 可视化技术
- **波形显示**：时域波形对比
- **频谱分析**：短时傅里叶变换频谱图
- **功率谱密度**：Welch方法频谱包络
- **MFCC特征**：梅尔频率倒谱系数分析

## 与02_mfcc.py的区别

| 特性 | 02_mfcc.py | audio_processing_demo.py |
|------|------------|--------------------------|
| 主要功能 | MFCC特征提取教学 | 音频处理效果演示 |
| 听觉对比 | 轻微差异 | 明显听觉差异 |
| 音频来源 | 录制/内置示例 | URL下载/录制/内置/生成 |
| 处理效果 | 预加重、分帧、加窗 | 音高变换、时间拉伸、失真等 |
| 可视化 | 基础图表 | 全面对比分析 |
| 文件保存 | 无 | 支持WAV文件保存 |

## 使用场景

1. **音频处理教学**：演示各种音频处理效果
2. **音效设计**：快速测试不同的音频处理组合
3. **音频分析**：对比分析处理前后的音频特征
4. **算法验证**：验证音频处理算法的效果

## 注意事项

1. **网络连接**：使用URL下载功能需要网络连接
2. **音频格式**：支持常见的音频格式（WAV、MP3等）
3. **处理时间**：复杂的处理效果可能需要较长时间
4. **文件权限**：确保有权限在当前目录保存文件

## 故障排除

### 常见问题

1. **导入错误**：确保所有依赖库已正确安装
2. **音频播放问题**：检查系统音频设备是否正常
3. **图表显示问题**：确保matplotlib后端配置正确
4. **网络下载失败**：检查网络连接和URL有效性

### 测试程序

程序提供了测试脚本：
```bash
python test_audio_demo.py
```

这个脚本会验证所有基本功能是否正常工作。

### 文件清理

程序提供了专门的清理脚本，用于管理生成的音频文件：

```bash
# 列出所有音频文件
python cleanup_audio_files.py --list

# 清理所有音频文件（需要确认）
python cleanup_audio_files.py --clean

# 强制清理所有音频文件（无需确认）
python cleanup_audio_files.py --clean --force

# 只清理下载的音频文件
python cleanup_audio_files.py --clean-downloaded

# 只清理处理后的音频文件
python cleanup_audio_files.py --clean-processed

# 交互式清理模式
python cleanup_audio_files.py
```

清理脚本会显示文件大小和数量，并在删除前请求确认，确保不会误删重要文件。

## 扩展开发

程序采用模块化设计，易于扩展新的音频处理效果：

```python
# 添加新的处理效果
def apply_new_effect(self, audio, parameters):
    # 实现新的处理算法
    processed_audio = your_algorithm(audio, parameters)
    return processed_audio
```

欢迎贡献新的音频处理算法和功能改进！
